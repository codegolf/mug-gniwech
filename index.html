<canvas id="p" width="1024" height="512"></canvas>
<img hidden id="g" src="sprite.png">
<script>
	s = 0;
	xpos = 2;
	ypos = 14
	// e=mur, f=porte, n=picd, k=picb, o=picg, j=pich, l=poutreV, m=poutreH g=coin, h=interE, i=interA,
	m = [
		"eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",
		"e k                   e        e",
		"e                     e       oe",
		"e                              e",
		"e                   eeeee      e",
		"e                              e",
		"e                              e",
		"e                              e",
		"e                              e",
		"e                              e",
		"e                              e",
		"e                              e",
		"e      j                       e",
		"e   leeee                      e",
		"en  l        j                fe",
		"eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"
		];
	c = p.getContext('2d');
	d = function(x,y,num){
		c.drawImage(g,num*32,0,32,32,x*32,y*32,32,32);
	} // x=left in canvas, y=top in canvas, num = order of sprite
	onkeyup = function(e){
		e = e.keyCode;
		if(e==37) s=4; //left
		if(e==38) s=2; //up
		if(e==39) s=3; //right
		if(e==40) s=1; //down
	}
	g.onload = function(){
		setInterval(function(){
			p.width = p.width;
			for(i=0;i<m.length;++i){
				for(j=0;j<m[i].length;++j){
					if(m[i][j] != " "){						
						temp = m[i][j].charCodeAt(0);
						d(j,i,temp-96);
					}
				}
			}
			switch(s){ //pas de victoire encore ( à améliorer bien sûr )
				case 0:
					break;
				case 1:
					if (m[ypos+1][xpos] == " "){ ypos++; }
					else if (m[ypos+1][xpos] != "e" && m[ypos+1][xpos] != "l" && m[ypos+1][xpos] != "m"){ 
						s=0;
						alert("you lost");
					} else {
						s=0;
					}
					break;
				case 2:
					if (m[ypos-1][xpos] == " "){ ypos--; }
					else if (m[ypos-1][xpos] != "e" && m[ypos-1][xpos] != "l" && m[ypos-1][xpos] != "m"){ 
						s=0;
						alert("you lost");
					} else {
						s=0;
					}
					break;
				case 3:
					if (m[ypos][xpos+1] == " "){ xpos++; }
					else if (m[ypos][xpos+1] != "e" && m[ypos][xpos+1] != "l" && m[ypos][xpos+1] != "m"){ 
						s=0;
						alert("you lost");
					} else {
						s=0;
					}
					break;
				case 4:
					if (m[ypos][xpos-1] == " "){ xpos--; }
					else if (m[ypos][xpos-1] != "e" && m[ypos][xpos-1] != "l" && m[ypos][xpos-1] != "m"){ 
						s=0;
						alert("you lost");
					} else {
						s=0;
					}
					break;
			}
			d(xpos,ypos,s);
		},100);
	}
</script>
